{
  "entities": {
    "Manuscript": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Manuscript",
      "type": "object",
      "description": "Represents a manuscript, which is a collection of chapters forming a book or other long-form writing project.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Manuscript entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the manuscript."
        },
        "author": {
          "type": "string",
          "description": "The author of the manuscript"
        },
        "templateId": {
          "type": "string",
          "description": "Reference to Template. (Relationship: Template 1:N Manuscript). Indicates the template used for this manuscript."
        },
        "coverImage": {
          "type": "string",
          "description": "url of the book cover image"
        },
        "wordCount": {
          "type": "number",
          "description": "Total word count for the manuscript."
        },
        "creationDate": {
          "type": "string",
          "description": "Date and time the manuscript was created.",
          "format": "date-time"
        },
        "lastModified": {
          "type": "string",
          "description": "Date and time the manuscript was last modified.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "title",
        "creationDate",
        "lastModified"
      ]
    },
    "Chapter": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Chapter",
      "type": "object",
      "description": "Represents a chapter within a manuscript.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Chapter entity."
        },
        "manuscriptId": {
          "type": "string",
          "description": "Reference to Manuscript. (Relationship: Manuscript 1:N Chapter). Indicates the manuscript this chapter belongs to."
        },
        "title": {
          "type": "string",
          "description": "The title of the chapter."
        },
        "content": {
          "type": "string",
          "description": "The text content of the chapter (rich text)."
        },
        "order": {
          "type": "number",
          "description": "The order of the chapter within the manuscript."
        },
        "wordCount": {
          "type": "number",
          "description": "Word count for the chapter."
        },
        "creationDate": {
          "type": "string",
          "description": "Date and time the chapter was created.",
          "format": "date-time"
        },
        "lastModified": {
          "type": "string",
          "description": "Date and time the chapter was last modified.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "manuscriptId",
        "title",
        "order",
        "creationDate",
        "lastModified"
      ]
    },
    "Template": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Template",
      "type": "object",
      "description": "Represents a template that defines a pre-built book format (e.g., novel, memoir, poetry).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Template entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the template (e.g., Novel, Memoir)."
        },
        "description": {
          "type": "string",
          "description": "A description of the template."
        },
        "formatDefinition": {
          "type": "string",
          "description": "JSON string that describes styles and formatting"
        }
      },
      "required": [
        "id",
        "name",
        "description"
      ]
    },
    "StylePreset": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "StylePreset",
      "type": "object",
      "description": "Represents a style preset for typography or paragraph settings.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the StylePreset entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the style preset."
        },
        "description": {
          "type": "string",
          "description": "A description of the style preset."
        },
        "settings": {
          "type": "string",
          "description": "JSON string representing the style settings (typography, paragraph, etc.)."
        }
      },
      "required": [
        "id",
        "name",
        "settings"
      ]
    },
    "Prompt": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Prompt",
      "type": "object",
      "description": "Represents a writing prompt or exercise to inspire creativity.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Prompt entity."
        },
        "text": {
          "type": "string",
          "description": "The text of the writing prompt."
        },
        "category": {
          "type": "string",
          "description": "A category for the writing prompt (e.g., Character, Plot, Setting)."
        }
      },
      "required": [
        "id",
        "text"
      ]
    },
    "Achievement": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Achievement",
      "type": "object",
      "description": "Represents a writing streak or achievement to gamify the writing process.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Achievement entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the achievement (e.g., Write for 7 days straight!)."
        },
        "description": {
          "type": "string",
          "description": "A description of the achievement."
        },
        "criteria": {
          "type": "string",
          "description": "A JSON string that describes the criteria for unlocking the achievement."
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "criteria"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/manuscripts/{manuscriptId}",
        "definition": {
          "entityName": "Manuscript",
          "schema": {
            "$ref": "#/backend/entities/Manuscript"
          },
          "description": "Represents a manuscript owned by a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The ID of the user who owns the manuscript."
            },
            {
              "name": "manuscriptId",
              "description": "The ID of the manuscript."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/manuscripts/{manuscriptId}/chapters/{chapterId}",
        "definition": {
          "entityName": "Chapter",
          "schema": {
            "$ref": "#/backend/entities/Chapter"
          },
          "description": "Represents a chapter within a specific manuscript owned by a user.",
          "params": [
            {
              "name": "userId",
              "description": "The ID of the user who owns the manuscript."
            },
            {
              "name": "manuscriptId",
              "description": "The ID of the manuscript."
            },
            {
              "name": "chapterId",
              "description": "The ID of the chapter."
            }
          ]
        }
      },
      {
        "path": "/templates/{templateId}",
        "definition": {
          "entityName": "Template",
          "schema": {
            "$ref": "#/backend/entities/Template"
          },
          "description": "Represents a template available to all users.",
          "params": [
            {
              "name": "templateId",
              "description": "The ID of the template."
            }
          ]
        }
      },
      {
        "path": "/stylePresets/{stylePresetId}",
        "definition": {
          "entityName": "StylePreset",
          "schema": {
            "$ref": "#/backend/entities/StylePreset"
          },
          "description": "Represents a style preset available to all users.",
          "params": [
            {
              "name": "stylePresetId",
              "description": "The ID of the style preset."
            }
          ]
        }
      },
      {
        "path": "/prompts/{promptId}",
        "definition": {
          "entityName": "Prompt",
          "schema": {
            "$ref": "#/backend/entities/Prompt"
          },
          "description": "Represents a writing prompt available to all users.",
          "params": [
            {
              "name": "promptId",
              "description": "The ID of the writing prompt."
            }
          ]
        }
      },
      {
        "path": "/achievements/{achievementId}",
        "definition": {
          "entityName": "Achievement",
          "schema": {
            "$ref": "#/backend/entities/Achievement"
          },
          "description": "Represents an achievement available to all users.",
          "params": [
            {
              "name": "achievementId",
              "description": "The ID of the achievement."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support NovelOS Studio's core features while adhering to the principles of Authorization Independence, Structural Segregation, and Access Modeling. User-owned data (Manuscripts and Chapters) are stored under the `/users/{userId}` path to ensure clear ownership. Templates, StylePresets, Prompts, and Achievements are stored at the root level, as they are global and shared across all users. Each document includes only data relevant to its entity and avoids complex relationships. \n\nAuthorization Independence is achieved by storing Manuscripts and Chapters as subcollections under the user ID, eliminating the need for complex `get()` calls in security rules. Each manuscript and chapter is inherently owned by the user.\n\nQAPs (Rules are not Filters) is supported through structural segregation, as each collection serves a distinct purpose with a defined security posture. List operations can be secured based on path ownership for user-specific data, and global collections can be read with appropriate restrictions."
  }
}